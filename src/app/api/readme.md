# API Documentation

## Endpoint: `/api/auth/sign-up`

### Description
This endpoint registers a new user. It performs the following actions:

- Checks if all required fields (`username`, `email`, `password`) are provided.
- Validates input using the `signUpValidation` schema.
- Checks if the email is already used by another user:
  - If used by a verified user, registration is blocked.
  - If used by an unverified user, the record is updated with the new username, password, and verification code.
- If the email is new, a new user is created with empty arrays for `solutions`, `submission`, and `solvedQuestions`.
- Generates a 6-digit verification code with 5-minute expiry.
- Hashes the password before storing it in the database.
- Sends a verification email containing the code using `sendVerificationEmail`.

### Method
`POST`

### Request Body

Send a JSON object with the following fields:

- `username`: A unique string (required)
- `email`: A valid email address (required)
- `password`: A string with a secure password (required)

#### Example Request
```json
{
  "username": "john_doe",
  "email": "john@example.com",
  "password": "securePassword123"
}
```
### Example Response
The response will be a JSON object with the following fields:

- `success` (boolean): Indicates whether the request was successful (`true`) or not (`false`).
- `message` (string): Provides additional information about the result. For example, success confirmation or error description.
- `userId` (string – MongoDB ObjectId): A unique identifier automatically generated by MongoDB for each user. It is used to distinguish one user from another in the database.


#### Success Response
```json
{
    "success": true,
    "message": "User registered successfully. Please verify your email",
    "userId": "7584752jfdkjfak..."
}
```
## Endpoint: `/api/auth/verify-code`

### Description
This endpoint verifies a user's account using the 6-digit verification code sent to their email during signup. It performs the following actions:

- Checks if all required fields (`id`, `code`) are provided.
- Validates the verification code using the `verifyCodeValidation` schema.
- Retrieves the user from the database using the provided `id`.
- Checks if the user exists and is not already verified.
- Compares the provided verification code with the one stored in the database.
- Ensures the verification code has not expired.
- Marks the user as verified if the code is valid and not expired.

### Method
`POST`

### Request Body

Send a JSON object with the following fields:

- `id`: The user's MongoDB ObjectId (required)
- `code`: The 6-digit verification code sent via email (required)

#### Example Request
```json
{
  "id": "7584752jfdkjfak...",
  "code": "123456"
}
```
### Example Response
The response will be a JSON object with the following fields:

- `success` (boolean): Indicates whether the request was successful (`true`) or not (`false`).
- `message` (string): Provides additional information about the result. For example, success confirmation or error description.
### Success Response
```json
{
    "success": true,
    "message": "Account verified successfully",
}
```
## Endpoint: `/api/auth/forget-password-mail`

### Description
This endpoint initiates the **password reset process** by sending a verification code to the user’s registered email address. It performs the following actions:

- Checks if the `email` field is provided in the request body.
- Validates the `email` format using the `forgetPasswordSchema`.
- Finds the user in the database by their email.
- If the user exists:
  - Generates a 6-digit verification code.
  - Sets the `forgetPasswordExpiry` to 5 minutes from the current time.
  - Updates the `verifyCode` in the user record.
  - Sends a verification email containing the reset code.
- If successful, responds with a success message confirming that the email was sent.

### Method
`POST`

### Request Body

Send a JSON object with the following fields:

- `email`: A valid registered email address (required)

#### Example Request
```json
{
  "email": "john@example.com"
}
```
### Example Response
The response will be a JSON object with the following fields:

- `success` (boolean): Indicates whether the request was successful (`true`) or not (`false`).
- `message` (string): Provides additional information about the result. For example, success confirmation or error description.
### Success Response
```json
{
    "success": true,
    "message": "Email send successfully"
}
```
## Endpoint: `/api/auth/forget-password`

### Description
This endpoint allows a user to **reset their password** using the verification code sent to their email during the forget password process. It performs the following actions:

- Checks if all required fields (`email`, `password`, `code`) are provided.
- Validates the input fields using the `forgetPasswordValidation` schema.
- Retrieves the user from the database using the provided `email`.
- Ensures the user exists.
- Compares the provided verification code with the one stored in the database.
- Ensures the verification code has not expired (valid for 5 minutes).
- If valid:
  - Hashes the new password with `bcrypt`.
  - Updates the user’s password.
  - Clears the `forgetPasswordExpiry`.
- Responds with a success message when the password is updated successfully.

### Method
`POST`

### Request Body

Send a JSON object with the following fields:

- `email`: The registered email address of the user (required)  
- `password`: The new password to be set (required)  
- `code`: The 6-digit verification code sent via email (required)  

#### Example Request
```json
{
  "email": "john@example.com",
  "password": "newSecurePassword123!",
  "code": "123456"
}
```
### Example Response
The response will be a JSON object with the following fields:

- `success` (boolean): Indicates whether the request was successful (`true`) or not (`false`).
- `message` (string): Provides additional information about the result. For example, success confirmation or error description.
### Success Response
```json
{
  "success": true,
  "message": "Password updated successfully"
}
```